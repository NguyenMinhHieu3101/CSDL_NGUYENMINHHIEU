--Cau 1--
SELECT MASP, TENSP FROM SANPHAM WHERE NUOCSX = 'TRUNGQUOC'
--Cau 2--
SELECT MASP, TENSP FROM SANPHAM WHERE DVT = 'CAY' OR DVT = 'QUYEN'
--Cau 3--
SELECT MASP, TENSP FROM SANPHAM WHERE MASP LIKE 'B%01'
--Cau 4--
SELECT MASP, TENSP FROM SANPHAM WHERE NUOCSX = 'TRUNGQUOC' AND GIA <= 40000 AND GIA >= 30000
--Cau 5--
SELECT MASP, TENSP FROM SANPHAM WHERE (NUOCSX = 'TRUNGQUOC' OR NUOCSX = 'THAILAN') AND GIA <= 40000 AND GIA >= 30000
--Cau 6--
SELECT SOHD, TRIGIA FROM HOADON WHERE (NGHD = '1/1/2007' OR NGHD = '2/1/2007')
--Cau 7--
SELECT SOHD, TRIGIA FROM HOADON WHERE (MONTH(NGHD) = 1 AND YEAR(NGHD) = 2007) ORDER BY NGHD, TRIGIA DESC
--Cau 8--
SELECT KHACHHANG.MAKH, HOTEN FROM (KHACHHANG JOIN HOADON ON KHACHHANG.MAKH = HOADON.MAKH) WHERE (NGHD = '1/1/2007')
--Cau 9--
SELECT SOHD, TRIGIA FROM (NHANVIEN JOIN HOADON ON NHANVIEN.MANV = HOADON.MANV) 
WHERE (NGHD = '28/10/2006' AND HOTEN = 'NGUYEN VAN B')

--Cau 10--
SELECT SP.MASP, SP.TENSP FROM KHACHHANG KH, HOADON HD, SANPHAM SP, CTHD CT
WHERE (CT.SOHD = HD.SOHD AND CT.MASP = SP.MASP AND KH.MAKH = HD.MAKH) 
	AND HOTEN = 'NGUYEN VAN A' AND MONTH(HD.NGHD) = 10 AND YEAR(HD.NGHD) = 2006

--Cau 11--
SELECT HOADON.SOHD FROM HOADON JOIN CTHD ON HOADON.SOHD = CTHD.SOHD WHERE (MASP = 'BB01')
UNION
SELECT HOADON.SOHD FROM HOADON JOIN CTHD ON HOADON.SOHD = CTHD.SOHD WHERE (MASP = 'BB02')
--Cau 12--
SELECT HOADON.SOHD FROM HOADON JOIN CTHD ON HOADON.SOHD = CTHD.SOHD WHERE (MASP = 'BB01'AND SL BETWEEN 10 AND 20)
UNION
SELECT HOADON.SOHD FROM HOADON JOIN CTHD ON HOADON.SOHD = CTHD.SOHD WHERE (MASP = 'BB02' AND SL BETWEEN 10 AND 20)
--Cau 13--
SELECT HOADON.SOHD FROM HOADON JOIN CTHD ON HOADON.SOHD = CTHD.SOHD WHERE (MASP = 'BB01'AND SL BETWEEN 10 AND 20)
INTERSECT
SELECT HOADON.SOHD FROM HOADON JOIN CTHD ON HOADON.SOHD = CTHD.SOHD WHERE (MASP = 'BB02' AND SL BETWEEN 10 AND 20)
--Cau 14--
SELECT SP.MASP, TENSP FROM SANPHAM SP, HOADON HD, CTHD CT WHERE (CT.MASP = SP.MASP AND HD.SOHD = CT.SOHD) AND NUOCSX = 'TRUNGQUOC' 
UNION
SELECT SP.MASP, TENSP FROM SANPHAM SP, HOADON HD, CTHD CT WHERE (CT.MASP = SP.MASP AND HD.SOHD = CT.SOHD) AND NGHD = 1/1/2007
--Cau 15--
SELECT SP.MASP, TENSP FROM SANPHAM SP
WHERE NOT EXISTS (SELECT * FROM CTHD CT WHERE CT.MASP = SP.MASP AND CT.MASP = SP.MASP)
--Cau 16--
SELECT SP.MASP, TENSP FROM SANPHAM SP
WHERE NOT EXISTS (SELECT * FROM CTHD CT, HOADON HD  
				  WHERE CT.MASP = SP.MASP AND HD.SOHD = CT.SOHD AND CT.MASP = SP.MASP AND YEAR(NGHD) = 2006)
--Cau 17--
SELECT SP.MASP, TENSP FROM SANPHAM SP
WHERE NOT EXISTS (SELECT * FROM CTHD CT, HOADON HD  
				  WHERE CT.MASP = SP.MASP AND HD.SOHD = CT.SOHD AND CT.MASP = SP.MASP AND YEAR(NGHD) = 2006) 
	 AND NUOCSX = 'TRUNGQUOC'

--Cau 18--
SELECT CT.SOHD FROM CTHD CT, SANPHAM SP, HOADON HD 
WHERE SP.MASP = CT.MASP AND CT.SOHD = HD.SOHD AND NUOCSX = 'SINGAPORE' AND YEAR(NGHD) = 2006 
GROUP BY CT.SOHD, NUOCSX
HAVING SUM(SL) <= ALL (SELECT SUM(SL) 
			FROM CTHD CT, SANPHAM SP, HOADON HD 
		       WHERE SP.MASP = CT.MASP AND CT.SOHD = HD.SOHD AND NUOCSX = 'SINGAPORE' AND YEAR(NGHD) = 2006  
			GROUP BY CT.SOHD)
--Cau 19--
SELECT COUNT(SOHD) AS SOKHACHCHUADK
FROM HOADON
WHERE MAKH IS NULL
--Cau 20--
SELECT COUNT(DISTINCT MASP) 
FROM CTHD CT JOIN HOADON HD ON CT.SOHD = HD.SOHD
WHERE YEAR(NGHD) = 2006
--Cau 21--
SELECT MAX(TRIGIA) AS MAXHD, MIN(TRIGIA) AS MINHD
FROM HOADON
--Cau 22--
SELECT AVG(TRIGIA) AS TRIGIATB
FROM HOADON
WHERE YEAR(NGHD) = 2006
--Cau 23--
SELECT SUM(TRIGIA) AS DOANHTHU
FROM HOADON
WHERE YEAR(NGHD) = 2006
--Cau 24--
SELECT SOHD 
FROM HOADON
WHERE TRIGIA >= ALL (SELECT TRIGIA FROM HOADON WHERE YEAR(NGHD) = 2006) AND YEAR(NGHD) =2006
--Cau 25--
SELECT HOTEN
FROM KHACHHANG KH, HOADON HD
WHERE KH.MAKH = HD.MAKH AND TRIGIA >= ALL (SELECT TRIGIA FROM HOADON WHERE YEAR(NGHD) = 2006) AND YEAR(NGHD) =2006
--Cau 26--
SELECT TOP 3 KH.MAKH,HOTEN, SUM(TRIGIA) AS TONGTRIGIA
FROM KHACHHANG KH, HOADON HD
WHERE KH.MAKH = HD.MAKH
GROUP BY KH.MAKH, HOTEN
ORDER BY SUM(TRIGIA) DESC

--Cau 27--
SELECT MASP, TENSP, GIA
FROM SANPHAM
WHERE GIA IN (SELECT DISTINCT TOP 3 GIA FROM SANPHAM ORDER BY GIA DESC)
--Cau 28--
SELECT MASP, TENSP, GIA
FROM SANPHAM
WHERE NUOCSX = 'THAILAN' AND GIA IN (SELECT DISTINCT TOP 3 GIA FROM SANPHAM ORDER BY GIA DESC)
--Cau 29--
SELECT MASP, TENSP, GIA
FROM SANPHAM
WHERE NUOCSX = 'TRUNGQUOC' AND GIA IN (SELECT DISTINCT TOP 3 GIA 
										FROM SANPHAM 
										WHERE NUOCSX = 'TRUNGQUOC' 
										ORDER BY GIA DESC)
--Cau 30--
SELECT TOP 3 KH.MAKH, HOTEN, RANK() OVER (ORDER BY SUM(TRIGIA) DESC) AS XEPHANG, SUM(TRIGIA) AS TONGTRIGIA
FROM KHACHHANG KH JOIN HOADON HD ON KH.MAKH = HD.MAKH
GROUP BY KH.MAKH, HOTEN
--Cau 31--
SELECT SUM(SL) AS TONGSANPHAMTQ
FROM SANPHAM SP, CTHD CT
WHERE SP.MASP = CT.MASP AND NUOCSX = 'TRUNGQUOC'
--Cau 32--
SELECT NUOCSX, SUM(SL) AS TONGSANPHAM
FROM SANPHAM SP, CTHD CT
WHERE SP.MASP = CT.MASP 
GROUP BY NUOCSX
--Cau 33--
SELECT NUOCSX, MAX(GIA) AS MAXGIA , MIN(GIA) AS MINGIA, AVG(GIA) AS AVGGIA
FROM SANPHAM
GROUP BY NUOCSX
--Cau 34--
SELECT NGHD, SUM(TRIGIA) AS DOANHTHU
FROM HOADON
GROUP BY NGHD
--Cau 35--
SELECT TENSP, SUM(SL) AS SOLUONG
FROM SANPHAM SP, CTHD CT, HOADON HD
WHERE SP.MASP = CT.MASP AND HD.SOHD = CT.SOHD
	AND MONTH(NGHD) = 10 AND YEAR(NGHD) = 2006
GROUP BY TENSP
--Cau 36--
SELECT MONTH(NGHD) AS THANG, SUM(TRIGIA) AS DOANHTHU
FROM HOADON
WHERE YEAR(NGHD) = 2006
GROUP BY MONTH(NGHD)
--Cau 37--
SELECT SOHD, COUNT(MASP) AS SOLOAISP
FROM CTHD
GROUP BY SOHD
HAVING COUNT(MASP) >= 4
--Cau 38--
SELECT SOHD
FROM CTHD CT, SANPHAM SP
WHERE CT.MASP = SP.MASP AND NUOCSX = 'VIETNAM'
GROUP BY SOHD
HAVING COUNT(CT.MASP) = 3
--Cau 39--
SELECT KH.MAKH, HOTEN, COUNT(SOHD) AS SOLUONGHD
FROM KHACHHANG KH, HOADON HD
GROUP BY KH.MAKH, HOTEN
HAVING COUNT(SOHD) >= ALL (SELECT COUNT(SOHD) FROM HOADON HD WHERE HD.MAKH = HD.MAKH)
--Cau 40--
SELECT MONTH(NGHD) AS THANG_CO_DOANHSO_MAX, SUM(TRIGIA) AS DOANH_SO
FROM HOADON 
GROUP BY MONTH(NGHD)
HAVING SUM (TRIGIA) >= ALL (SELECT SUM(TRIGIA) FROM HOADON GROUP BY MONTH(NGHD))

--Cau 41--
SELECT SP.MASP, TENSP
FROM SANPHAM SP, HOADON HD, CTHD CT
WHERE SP.MASP = CT.MASP AND HD.SOHD = CT.SOHD AND YEAR(NGHD) = 2006
GROUP BY SP.MASP, TENSP
HAVING SUM(SL) <= ALL (SELECT SUM(SL) 
						FROM SANPHAM SP, HOADON HD, CTHD CT
						WHERE SP.MASP = CT.MASP AND HD.SOHD = CT.SOHD AND YEAR(NGHD) = 2006
						GROUP BY SP.MASP, TENSP)

--Cau 42--
SELECT NUOCSX, MAX(GIA) AS GIABANCAONHAT
FROM SANPHAM
GROUP BY NUOCSX
--Cau 43--
SELECT NUOCSX AS NUOCSX_3SP_GIAKHACNHAU
FROM SANPHAM
GROUP BY NUOCSX
HAVING COUNT(DISTINCT GIA) = 3

-- Cau 44--
SELECT KH.MAKH, HOTEN, COUNT (SOHD) AS SOLANMUAHANG
FROM KHACHHANG KH JOIN HOADON HD ON HD.MAKH = KH.MAKH
GROUP BY KH.MAKH, HOTEN 
HAVING COUNT (SOHD) >= ALL (SELECT TOP 10 COUNT (SOHD) 
							FROM KHACHHANG KH JOIN HOADON HD ON HD.MAKH = KH.MAKH
							GROUP BY KH.MAKH, HOTEN
							ORDER BY COUNT(SOHD) DESC
							)